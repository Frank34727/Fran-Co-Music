<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Music Site - Upload & Play</title>

  <!-- Bootstrap & FontAwesome -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>

  <style>
    body {
      background-color: #121212;
      color: white;
    }
    .sidebar {
      min-height: 100vh;
      background-color: #1e1e1e;
    }
    .sidebar a {
      color: white;
      text-decoration: none;
      padding: 12px;
      display: block;
    }
    .sidebar a:hover {
      background-color: #2a2a2a;
    }
    .top-search {
      background-color: #1e1e1e;
      padding: 10px 20px;
    }
    .content-box {
      background-color: #2a2a2a;
      border-radius: 10px;
      padding: 20px;
      margin-top: 20px;
    }
    @media (max-width: 768px) {
      .sidebar {
        display: none;
      }
    }
  </style>
</head>
<body>
  

<div class="container-fluid">
  <div class="row">
    <!-- SIDEBAR -->
    <nav class="col-md-3 col-lg-2 d-md-block sidebar p-3">
      <h4 class="text-warning">Fran-CO</h4>
      <div class="text-center my-3">
        <img src="../content/img/logo 2.png" class="rounded-circle" alt="Profile" width="95%">
        <p class="text-truncate text-white mt-2">PerfectSound with FranCo Music...</p>
      </div>
      <a href="#"><i class="fas fa-home"></i> Home</a>
      <a href="./create.html"><i class="fas fa-plus-circle"></i> Create</a>
      <a href="./library.html"><i class="fas fa-folder-open"></i> Library</a>
      <a href="#"><i class="fas fa-compass"></i> Explore</a>
      <a href="#"><i class="fas fa-search"></i> Search</a>
      <a href="#"><i class="fas fa-bell"></i> Notifications</a>
      <div class="mt-auto">
        <div class="bg-danger p-3 rounded text-center">
          <p>Go Pro<br><small>Unlock features</small></p>
          <button class="btn btn-light btn-sm">Upgrade</button>
        </div>
      </div>
    </nav>

    <!-- MAIN CONTENT -->
    <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
      <!-- TOP SEARCH -->
      <div class="top-search d-flex justify-content-between align-items-center mt-3 flex-wrap">
        <input type="text" class="form-control w-100 w-md-50 me-md-3 mb-2" placeholder="Create your own song"/>
        <a href="./create.html" class="w-100 w-md-auto">
          <button class="btn btn-warning w-100">Create <i class="fas fa-music"></i></button>
        </a>
      </div>

      <!-- FEATURE SECTION -->
      <div class="content-box">
        <span class="badge bg-danger mb-2">NEW FEATURES</span>
        <h2>A whole new level of creative control.</h2>
        <p>Unlock your inner artist, at any skill level. Start with a melody, phrase, or full song. Then break it open â€” split stems, play with the song structure, rewrite lyrics, remix the vibe.</p>
        <button class="btn btn-light">#####</button>

        <div class="row mt-4">
          <div class="col-sm-12 col-md-4 mb-3">
            <div class="bg-dark p-3 rounded text-center">
              <p>Stem Extraction</p>
              <img src="../content/img/" class="img-fluid" alt="Stem"/>
            </div>
          </div>
          <div class="col-sm-12 col-md-4 mb-3">
            <div class="bg-dark p-3 rounded text-center">
              <h4>Music heal the Soul</h4>
              <img src="../content/img/images.jpeg" class="img-fluid" alt="Editor">
            </div>
          </div>
          <div class="col-sm-12 col-md-4 mb-3">
            <div class="bg-dark p-3 rounded text-center">
              <h4>Music is the future</h4>
              <img src="../content/img/images.jpeg" class="img-fluid" alt="Upload">
            </div>
          </div>
        </div>
      </div>

      <!-- UPLOAD MUSIC SECTION -->
      <div class="content-box mt-4 mb-5">
        <h4 class="mb-3">Upload Your Music</h4>
        <input type="text" id="artistName" class="form-control mb-2" placeholder="Artist Name" required />
        <input type="text" id="songTitle" class="form-control mb-2" placeholder="Song Title" required />
        <input type="file" id="coverImage" accept="image/*" class="form-control mb-2" />
        <input type="file" id="musicFile" accept="audio/*" class="form-control mb-2" />
        <button class="btn btn-warning w-100" onclick="uploadMusic()">Upload Music</button>
      </div>
    </main>
  </div>
</div>

<!-- Firebase & JS Logic -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-app.js";
  import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-storage.js";
  import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCB_VrWHGQ7ZIa8RfU1hpStTK4d2euh1JQ",
    authDomain: "francomusic-c6d4e.firebaseapp.com",
    projectId: "francomusic-c6d4e",
    storageBucket: "francomusic-c6d4e.appspot.com",
    messagingSenderId: "589343387628",
    appId: "1:589343387628:web:43ee54b1b3051ae1401ac9"
  };

  const app = initializeApp(firebaseConfig);
  const storage = getStorage(app);
  const db = getFirestore(app);

  window.uploadMusic = async function () {
    const artistName = document.getElementById("artistName").value.trim();
    const songTitle = document.getElementById("songTitle").value.trim();
    const musicFile = document.getElementById("musicFile").files[0];
    const coverImage = document.getElementById("coverImage").files[0];

    if (!artistName || !songTitle || !musicFile) {
      alert("Please fill in all fields and select a music file.");
      return;
    }

    try {
      const musicRef = ref(storage, `music/${Date.now()}_${musicFile.name}`);
      await uploadBytes(musicRef, musicFile);
      const musicURL = await getDownloadURL(musicRef);

      let coverURL = "";
      if (coverImage) {
        const coverRef = ref(storage, `covers/${Date.now()}_${coverImage.name}`);
        await uploadBytes(coverRef, coverImage);
        coverURL = await getDownloadURL(coverRef);
      }

      await addDoc(collection(db, "songs"), {
        artist: artistName,
        title: songTitle,
        music: musicURL,
        cover: coverURL
      });

      alert(" Song uploaded successfully!");
      document.getElementById("artistName").value = "";
      document.getElementById("songTitle").value = "";
      document.getElementById("musicFile").value = "";
      document.getElementById("coverImage").value = "";
    } catch (error) {
      console.error("Upload error:", error);
      alert(" Failed to upload song.");
    }
  };
</script>

</body>
</html>
